// ***********************************************************************
// Assembly         : Calc64BaseTests
// Author           : Mir
// Created          : 08-28-2022
//
// Last Modified By : Mir
// Last Modified On : 08-28-2022
// ***********************************************************************
// <copyright file="StandardOperationsTests.cs" company="JC-Soft">
//     Copyright © JC-Soft 2022
// </copyright>
// <summary></summary>
// ***********************************************************************
using Microsoft.VisualStudio.TestTools.UnitTesting;
using System;
using System.Linq;

/// <summary>
/// The Tests namespace.
/// </summary>
/// <autogeneratedoc />
namespace Calc64Base.Tests
{
    /// <summary>
    /// Defines test class StandardOperationsTests.
    /// </summary>
    /// <autogeneratedoc />
    [TestClass()]
    public class StandardOperationsTests
    {
        /// <summary>
        /// Enum Exceptions
        /// </summary>
        /// <autogeneratedoc />
        private enum Exceptions
        {
            /// <summary>
            /// The none
            /// </summary>
            /// <autogeneratedoc />
            None,
            /// <summary>
            /// The e div by zero ex
            /// </summary>
            /// <autogeneratedoc />
            eDivByZeroEx
        }

        /// <summary>
        /// Gets all test1.
        /// </summary>
        /// <param name="sOp">The s op.</param>
        /// <param name="s">The s.</param>
        /// <param name="argL">The argument l.</param>
        /// <param name="xResult">if set to <c>true</c> [x result].</param>
        /// <param name="erg">The erg.</param>
        /// <param name="e">The e.</param>
        /// <autogeneratedoc />
        [DataTestMethod()]
        [DataRow("+", "1", new Int64[] { 0, 0 },true,new Int64[] {0L,0L })]
        [DataRow("+", "2", new Int64[] { 1L, 1L }, true, new Int64[] { 2L, 1L })]
        [DataRow("+", "3", new Int64[] { 1L, -1L }, true, new Int64[] { 0L, -1L })]
        [DataRow("+", "4", new Int64[] { 1000000000000L, -999999999999L }, true, new Int64[] { 1L, -999999999999L })]
        [DataRow("+", "5", new Int64[] { Int64.MaxValue, 1L }, true, new Int64[] { -9223372036854775808L, 1L })]
        [DataRow("-", "1", new Int64[] { 0L, 0L }, true, new Int64[] { 0L, 0L })]
        [DataRow("-", "2", new Int64[] { 1L, 1L }, true, new Int64[] { 0L, 1L })]
        [DataRow("-", "3", new Int64[] { -1L, 1L }, true, new Int64[] { 2L, 1L })]
        [DataRow("-", "4", new Int64[] { 1000000000000L, 999999999999L }, true, new Int64[] { -1L, 999999999999L })]
        [DataRow("-", "5", new Int64[] { 1L, Int64.MinValue }, true, new Int64[] { 9223372036854775807L, -9223372036854775808L })]
        [DataRow("*", "1", new Int64[] { 0L, 0L }, true, new Int64[] { 0L, 0L })]
        [DataRow("*", "2", new Int64[] { 1L, -2L }, true, new Int64[] { -2L, -2L })]
        [DataRow("*", "3", new Int64[] { -2L, 1L }, true, new Int64[] { -2L, 1L })]
        [DataRow("*", "4", new Int64[] { -3L, -2L }, true, new Int64[] { 6L, -2L })]
        [DataRow("*", "5", new Int64[] { 1000000000L, 999999999L }, true, new Int64[] { 999999999000000000L, 999999999L })]
        [DataRow("*", "6", new Int64[] { Int64.MinValue, -10L }, true, new Int64[] { 0L, -10L })] // ??
        [DataRow("/", "1", new Int64[] { 0L, 0L }, true, new Int64[] { 0L, 0L },(object)Exceptions.eDivByZeroEx)]
        [DataRow("/", "2", new Int64[] { 1L, -2L }, true, new Int64[] { -2L, -2L })]
        [DataRow("/", "3", new Int64[] { -2L, 1L }, true, new Int64[] { 0L, 1L })]
        [DataRow("/", "4", new Int64[] { -2L, -3L }, true, new Int64[] { 1L, -3L })]
        [DataRow("/", "5", new Int64[] {  999999999L, 1000000000L }, true, new Int64[] { 1L, 1000000000L })]
        [DataRow("/", "6", new Int64[] { -10L, Int64.MinValue }, true, new Int64[] { Int64.MaxValue / 10L, Int64.MinValue })] // ??
        [DataRow("^", "1", new Int64[] { 0L, 0L }, true, new Int64[] { 1L, 0L })]
        [DataRow("^", "2", new Int64[] { 1L, -2L }, true, new Int64[] { -2L, -2L })]
        [DataRow("^", "3", new Int64[] { -2L, 1L }, true, new Int64[] { 1L, 1L })]
        [DataRow("^", "4", new Int64[] { 2L, 3L }, true, new Int64[] { 9L, 3L })]
        [DataRow("^", "5", new Int64[] { 3L, 2000000L}, true, new Int64[] { 8000000000000000000L, 2000000L })] //??
        [DataRow("^", "6", new Int64[] { Int64.MaxValue, 1L }, true, new Int64[] { 1L, 1L })] // ??
        [DataRow("±", "1", new Int64[] { 0L }, true, new Int64[] { 0L })]
        [DataRow("±", "2", new Int64[] { 1L }, true, new Int64[] { -1L })]
        [DataRow("±", "3", new Int64[] { -2L }, true, new Int64[] { 2L })]
        [DataRow("±", "4", new Int64[] { long.MaxValue }, true, new Int64[] { -long.MaxValue })]
        [DataRow("±", "5", new Int64[] { long.MinValue }, true, new Int64[] { long.MinValue })] //??
        [DataRow("~", "1", new Int64[] { 0L }, true, new Int64[] { -1L })]
        [DataRow("~", "2", new Int64[] { 1L }, true, new Int64[] { -2L })]
        [DataRow("~", "3", new Int64[] { -2L }, true, new Int64[] { 1L })]
        [DataRow("~", "4", new Int64[] { long.MaxValue }, true, new Int64[] { long.MinValue })]
        [DataRow("~", "5", new Int64[] { long.MinValue }, true, new Int64[] { long.MaxValue })] //??
        [DataRow("&", "1", new Int64[] { 0L, 0L }, true, new Int64[] { 0L, 0L })]
        [DataRow("&", "2", new Int64[] { 1L, -2L }, true, new Int64[] { 0L, -2L })]
        [DataRow("&", "3", new Int64[] { -2L, 1L }, true, new Int64[] { 0L, 1L })]
        [DataRow("&", "4", new Int64[] { -3L, -2L }, true, new Int64[] { -4L, -2L })]
        [DataRow("&", "5", new Int64[] { 1000000000L, 999999999L }, true, new Int64[] { 999999488L, 999999999L })]
        [DataRow("&", "6", new Int64[] { Int64.MinValue, -10L }, true, new Int64[] { Int64.MinValue, -10L })] 
        [DataRow("&", "7", new Int64[] { Int64.MinValue, 10L }, true, new Int64[] { 0, 10L })] 
        [DataRow("|", "1", new Int64[] { 0, 0 }, true, new Int64[] { 0L, 0L })]
        [DataRow("|", "2", new Int64[] { 1L, 1L }, true, new Int64[] { 1L, 1L })]
        [DataRow("|", "3", new Int64[] { 1L, -1L }, true, new Int64[] { -1L, -1L })]
        [DataRow("|", "4", new Int64[] { 1000000000000L, -999999999999L }, true, new Int64[] { -4095L, -999999999999L })]
        [DataRow("|", "5", new Int64[] { Int64.MaxValue, 1L }, true, new Int64[] { Int64.MaxValue, 1L })]
        [DataRow("x", "1", new Int64[] { 0, 0 }, true, new Int64[] { 0L, 0L })]
        [DataRow("x", "2", new Int64[] { 1L, 1L }, true, new Int64[] { 0L, 1L })]
        [DataRow("x", "3", new Int64[] { 1L, -1L }, true, new Int64[] { -2L, -1L })]
        [DataRow("x", "4", new Int64[] { 1000000000000L, -999999999999L }, true, new Int64[] { -8191L, -999999999999L })]
        [DataRow("x", "5", new Int64[] { Int64.MaxValue, 1L }, true, new Int64[] { Int64.MaxValue-1, 1L })]
        [DataRow("&~", "1", new Int64[] { 0L, 0L }, true, new Int64[] { 0L, 0L })]
        [DataRow("&~", "2", new Int64[] { 1L, -2L }, true, new Int64[] { -2L, -2L })]
        [DataRow("&~", "3", new Int64[] { -2L, 1L }, true, new Int64[] { 1L, 1L })]
        [DataRow("&~", "4", new Int64[] { -3L, -2L }, true, new Int64[] { 2L, -2L })]
        [DataRow("&~", "5", new Int64[] { 1000000000L, 999999999L }, true, new Int64[] { 511, 999999999L })]
        [DataRow("&~", "6", new Int64[] { Int64.MinValue, -10L }, true, new Int64[] { Int64.MaxValue-9, -10L })]
        [DataRow("&~", "7", new Int64[] { Int64.MinValue, 10L }, true, new Int64[] { 10, 10L })]
        [DataRow("|~", "1", new Int64[] { 0, 0 }, true, new Int64[] { -1L, 0L })]
        [DataRow("|~", "2", new Int64[] { 1L, 1L }, true, new Int64[] { -1L, 1L })]
        [DataRow("|~", "3", new Int64[] { 1L, -1L }, true, new Int64[] { -1L, -1L })]
        [DataRow("|~", "4", new Int64[] { 1000000000000L, -999999999999L }, true, new Int64[] { -999999995905L, -999999999999L })]
        [DataRow("|~", "5", new Int64[] { Int64.MaxValue, 1L }, true, new Int64[] { Int64.MinValue+1, 1L })]
        [DataRow("x~", "1", new Int64[] { 0, 0 }, true, new Int64[] { -1L, 0L })]
        [DataRow("x~", "2", new Int64[] { 1L, 1L }, true, new Int64[] { -1L, 1L })]
        [DataRow("x~", "3", new Int64[] { 1L, -1L }, true, new Int64[] { 1L, -1L })]
        [DataRow("x~", "4", new Int64[] { 1000000000000L, -999999999999L }, true, new Int64[] { 8190L, -999999999999L })]
        [DataRow("x~", "5", new Int64[] { Int64.MaxValue, 1L }, true, new Int64[] { Int64.MinValue + 1, 1L })]
        [DataRow("%", "1", new Int64[] { 0, 0 }, true, new Int64[] { 0L, 0L }, (object)Exceptions.eDivByZeroEx)]
        [DataRow("%", "2", new Int64[] { 1L, 1L }, true, new Int64[] { 0L, 1L })]
        [DataRow("%", "3", new Int64[] { 1L, -1L }, true, new Int64[] { 0L, -1L })]
        [DataRow("%", "4", new Int64[] { 1000000000000L, -999999999999L }, true, new Int64[] { -999999999999L, -999999999999L })]
        [DataRow("%", "5", new Int64[] { Int64.MaxValue, 1L }, true, new Int64[] { 1, 1L })]
        [DataRow("==", "1", new Int64[] { 0, 0 }, true, new Int64[] { -1L, 0L })]
        [DataRow("==", "2", new Int64[] { 1L, 1L }, true, new Int64[] { -1L, 1L })]
        [DataRow("==", "3", new Int64[] { 1L, -1L }, true, new Int64[] { 1L, -1L })]
        [DataRow("==", "4", new Int64[] { 1000000000000L, -999999999999L }, true, new Int64[] { 8190L, -999999999999L })]
        [DataRow("==", "5", new Int64[] { Int64.MaxValue, 1L }, true, new Int64[] { Int64.MinValue + 1, 1L })]
        [DataRow("MR", "1", new Int64[] { 0, 0 }, true, new Int64[] { 0L, 0L })]
        [DataRow("MR", "2", new Int64[] { 1L, 1L }, true, new Int64[] { 1L, 1L })]
        [DataRow("MR", "3", new Int64[] { 1L, -1L }, true, new Int64[] { -1L, -1L })]
        [DataRow("MR", "4", new Int64[] { 1000000000000L, -999999999999L }, true, new Int64[] { -999999999999L, -999999999999L })]
        [DataRow("MR", "5", new Int64[] { Int64.MaxValue, 1L }, true, new Int64[] { 1L, 1L })]
        [DataRow("MS", "1", new Int64[] { 0, 0 }, true, new Int64[] { 0L, 0L })]
        [DataRow("MS", "2", new Int64[] { 1L, 1L }, true, new Int64[] { 1L, 1L })]
        [DataRow("MS", "3", new Int64[] { 1L, -1L }, true, new Int64[] { 1L, 1L })]
        [DataRow("MS", "4", new Int64[] { 1000000000000L, -999999999999L }, true, new Int64[] { 1000000000000L, 1000000000000L })]
        [DataRow("MS", "5", new Int64[] { Int64.MaxValue, 1L }, true, new Int64[] { Int64.MaxValue, Int64.MaxValue })]
        [DataRow("M+", "1", new Int64[] { 0, 0 }, true, new Int64[] { 0L, 0L })]
        [DataRow("M+", "2", new Int64[] { 1L, 1L }, true, new Int64[] { 1L, 2L })]
        [DataRow("M+", "3", new Int64[] { 1L, -1L }, true, new Int64[] { 1L, 0L })]
        [DataRow("M+", "4", new Int64[] { 1000000000000L, -999999999999L }, true, new Int64[] { 1000000000000L, 1L })]
        [DataRow("M+", "5", new Int64[] { Int64.MaxValue, 1L }, true, new Int64[] { Int64.MaxValue, Int64.MinValue })]
        [DataRow("M-", "1", new Int64[] { 0, 0 }, true, new Int64[] { 0L, 0L })]
        [DataRow("M-", "2", new Int64[] { 1L, 1L }, true, new Int64[] { 1L, 0L })]
        [DataRow("M-", "3", new Int64[] { 1L, -1L }, true, new Int64[] { 1L, -2L })]
        [DataRow("M-", "4", new Int64[] { 1000000000000L, -999999999999L }, true, new Int64[] { 1000000000000L, -1999999999999L })]
        [DataRow("M-", "5", new Int64[] { Int64.MaxValue, 1L }, true, new Int64[] { Int64.MaxValue, Int64.MinValue + 2 })]
        [DataRow("MC", "1", new Int64[] { 0, 0 }, true, new Int64[] { 0L, 0L })]
        [DataRow("MC", "2", new Int64[] { 1L, 1L }, true, new Int64[] { 1L, 0L })]
        [DataRow("MC", "3", new Int64[] { 1L, -1L }, true, new Int64[] { 1L, 0L })]
        [DataRow("MC", "4", new Int64[] { 1000000000000L, -999999999999L }, true, new Int64[] { 1000000000000L, 0L })]
        [DataRow("MC", "5", new Int64[] { Int64.MaxValue, 1L }, true, new Int64[] { Int64.MaxValue, 0L })]
        public void GetAllTest1(string sOp,string _, Int64[] argL,bool xResult, Int64[] erg, object e = null)
        {
            var co = StandardOperations.GetAll().First((o)=>o.ShortDesc==sOp);
            Assert.IsNotNull(co);
            var arg = new object[argL.Length];
            for (int i = 0; i < arg.Length; i++)
                arg[i] = argL[i];
            if (e==null)
            Assert.AreEqual(xResult, co.Execute(ref arg));
            else
                switch ((Exceptions)e)
                {
                    case Exceptions.eDivByZeroEx : Assert.ThrowsException<DivideByZeroException>(()=> co.Execute(ref arg));break;
                    default: Assert.Fail();break;
                }
            for (int i = 0; i < arg.Length; i++)
                Assert.AreEqual(erg[i], arg[i],$"erg[{i}]({erg[i]}) == arg[{i}]({arg[i]})");
        }
    }
}