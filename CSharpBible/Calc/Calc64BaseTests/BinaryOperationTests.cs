// ***********************************************************************
// Assembly         : Calc64BaseTests
// Author           : Mir
// Created          : 08-28-2022
//
// Last Modified By : Mir
// Last Modified On : 08-28-2022
// ***********************************************************************
// <copyright file="BinaryOperationTests.cs" company="JC-Soft">
//     Copyright © JC-Soft 2022
// </copyright>
// <summary></summary>
// ***********************************************************************
using Microsoft.VisualStudio.TestTools.UnitTesting;
using Calc64Base;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

/// <summary>
/// The Tests namespace.
/// </summary>
/// <autogeneratedoc />
namespace Calc64Base.Tests
{
    /// <summary>
    /// Defines test class BinaryOperationTests.
    /// </summary>
    /// <autogeneratedoc />
    [TestClass()]
    public class BinaryOperationTests
    {
        /// <summary>
        /// Defines the test method BinaryOperationTest.
        /// </summary>
        /// <autogeneratedoc />
        [TestMethod()]
        public void BinaryOperationTest()
        {
            var bco = new BinaryOperation("?2", "Quest2", (a, r) => a ^ r);
            Assert.AreEqual("?2",bco.ShortDescr);
            Assert.AreEqual("Quest2", bco.LongDescr);
            Assert.AreEqual(true, bco.NeedAccumulator);
            Assert.AreEqual(true, bco.NeedRegister);
            Assert.AreEqual(false, bco.NeedMemory);
        }

        /// <summary>
        /// Defines the test method ExecuteTest.
        /// </summary>
        /// <autogeneratedoc />
        [TestMethod()]
        public void ExecuteTest()
        {
            var bco = new BinaryOperation("?", "Quest", (a,r) => a ^ r);
            var arg = CalcOperation.CreateArguments(bco);
            arg[0] = 5L;
            arg[1] = 6L;
            Assert.AreEqual(true, bco.Execute(ref arg));
            Assert.AreEqual(3L, arg[0]);
            Assert.AreEqual(6L, arg[1]);
        }
    }
}