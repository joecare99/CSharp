// ***********************************************************************
// Assembly         : BaseLib_netTests
// Author           : Mir
// Created          : 03-27-2023
//
// Last Modified By : Mir
// Last Modified On : 03-27-2023
// ***********************************************************************
// <copyright file="ClassHelperTests.cs" company="JC-Soft">
//     Copyright © JC-Soft 2023
// </copyright>
// <summary></summary>
// ***********************************************************************
using Microsoft.VisualStudio.TestTools.UnitTesting;
using System;
using System.Collections.Generic;

/// <summary>
/// The Tests namespace.
/// </summary>
/// <autogeneratedoc />
namespace BaseLib.Helper.Tests
{
    /// <summary>
    /// Enum PropEnum
    /// </summary>
    /// <autogeneratedoc />
    public enum PropEnum
    {
        /// <summary>
        /// The bool property
        /// </summary>
        /// <autogeneratedoc />
        boolProp,
        /// <summary>
        /// The double property
        /// </summary>
        /// <autogeneratedoc />
        doubleProp,
        /// <summary>
        /// The enum property
        /// </summary>
        /// <autogeneratedoc />
        enumProp,
        /// <summary>
        /// The float property
        /// </summary>
        /// <autogeneratedoc />
        floatProp,
        /// <summary>
        /// The int property
        /// </summary>
        /// <autogeneratedoc />
        intProp,
        /// <summary>
        /// The long property
        /// </summary>
        /// <autogeneratedoc />
        longProp,
        /// <summary>
        /// The object property
        /// </summary>
        /// <autogeneratedoc />
        objectProp,
        /// <summary>
        /// The short property
        /// </summary>
        /// <autogeneratedoc />
        shortProp,
        /// <summary>
        /// The string property
        /// </summary>
        /// <autogeneratedoc />
        stringProp,
        /// <summary>
        /// The uint property
        /// </summary>
        /// <autogeneratedoc />
        uintProp,
        /// <summary>
        /// The ulong property
        /// </summary>
        /// <autogeneratedoc />
        ulongProp,
        /// <summary>
        /// The ushort property
        /// </summary>
        /// <autogeneratedoc />
        ushortProp,
    }

    /// <summary>
    /// Defines test class ClassHelperTests.
    /// </summary>
    /// <autogeneratedoc />
    [TestClass()]
    public class ClassHelperTests
    {
        /// <summary>
        /// Gets or sets a value indicating whether [bool property].
        /// </summary>
        /// <value><c>true</c> if [bool property]; otherwise, <c>false</c>.</value>
        /// <autogeneratedoc />
        public bool boolProp { get; set; } = false;
        /// <summary>
        /// Gets or sets the int property.
        /// </summary>
        /// <value>The int property.</value>
        /// <autogeneratedoc />
        public int intProp { get; set; } = default;
        /// <summary>
        /// Gets or sets the uint property.
        /// </summary>
        /// <value>The uint property.</value>
        /// <autogeneratedoc />
        public uint uintProp { get; set; } = default;
        /// <summary>
        /// Gets or sets the float property.
        /// </summary>
        /// <value>The float property.</value>
        /// <autogeneratedoc />
        public float floatProp { get; set; } = default;
        /// <summary>
        /// Gets or sets the double property.
        /// </summary>
        /// <value>The double property.</value>
        /// <autogeneratedoc />
        public double doubleProp { get; set; } = default;
        /// <summary>
        /// Gets or sets the short property.
        /// </summary>
        /// <value>The short property.</value>
        /// <autogeneratedoc />
        public short shortProp { get; set; } = default;
        /// <summary>
        /// Gets or sets the ushort property.
        /// </summary>
        /// <value>The ushort property.</value>
        /// <autogeneratedoc />
        public ushort ushortProp { get; set; } = default;
        /// <summary>
        /// Gets or sets the long property.
        /// </summary>
        /// <value>The long property.</value>
        /// <autogeneratedoc />
        public long longProp { get; set; } = default;
        /// <summary>
        /// Gets or sets the ulong property.
        /// </summary>
        /// <value>The ulong property.</value>
        /// <autogeneratedoc />
        public ulong ulongProp { get; set; } = default;
        /// <summary>
        /// Gets or sets the object property.
        /// </summary>
        /// <value>The object property.</value>
        /// <autogeneratedoc />
        public object objectProp { get; set; } = new();
        /// <summary>
        /// Gets or sets the string property.
        /// </summary>
        /// <value>The string property.</value>
        /// <autogeneratedoc />
        public string stringProp { get; set; } = "";
        /// <summary>
        /// Gets or sets the enum property.
        /// </summary>
        /// <value>The enum property.</value>
        /// <autogeneratedoc />
        public PropEnum enumProp { get; set; } = default;

        /// <summary>
        /// Gets or sets the <see cref="System.Object"/> with the specified ix.
        /// </summary>
        /// <param name="ix">The ix.</param>
        /// <returns>System.Object.</returns>
        /// <autogeneratedoc />
        private object this[string ix] { get => GetValue(ix); set => SetVal(ix, value); }
        /// <summary>
        /// Gets or sets the <see cref="System.Object"/> with the specified ix.
        /// </summary>
        /// <param name="ix">The ix.</param>
        /// <returns>System.Object.</returns>
        /// <autogeneratedoc />
        private object this[PropEnum ix]
        {
            get => GetValue(ix.ToString());
            set => SetVal(ix.ToString(), value);
        }

        /// <summary>
        /// Sets the value.
        /// </summary>
        /// <param name="prop">The property.</param>
        /// <param name="value">The value.</param>
        /// <autogeneratedoc />
        private void SetVal(string prop, object value) => _ = prop switch
        {
            nameof(boolProp) => (object)(boolProp = (bool)value),
            nameof(intProp) => intProp = (int)value,
            nameof(uintProp) => uintProp = (uint)value,
            nameof(floatProp) => floatProp = (float)value,
            nameof(doubleProp) => doubleProp = (double)value,
            nameof(shortProp) => shortProp = (short)value,
            nameof(ushortProp) => ushortProp = (ushort)value,
            nameof(longProp) => longProp = (long)value,
            nameof(ulongProp) => ulongProp = (ulong)value,
            nameof(stringProp) => stringProp = (string)value,
            nameof(enumProp) => enumProp = (PropEnum)value,
            _ => throw new NotImplementedException(),
        };

        /// <summary>
        /// Gets the value.
        /// </summary>
        /// <param name="prop">The property.</param>
        /// <returns>System.Object.</returns>
        /// <autogeneratedoc />
        private object GetValue(string prop) => prop switch
        {
            nameof(boolProp) => boolProp,
            nameof(intProp) => intProp,
            nameof(uintProp) => uintProp,
            nameof(floatProp) => floatProp,
            nameof(doubleProp) => doubleProp,
            nameof(shortProp) => shortProp,
            nameof(ushortProp) => ushortProp,
            nameof(longProp) => longProp,
            nameof(ulongProp) => ulongProp,
            nameof(stringProp) => stringProp,
            nameof(enumProp) => enumProp,
            _ => throw new NotImplementedException(),
        };

        /// <summary>
        /// Clears this instance.
        /// </summary>
        /// <autogeneratedoc />
        private void Clear()
        {
            boolProp = default;
            intProp = default;
            uintProp = default;
            floatProp = default;
            doubleProp = default;
            shortProp = default;
            ushortProp = default;
            longProp = default;
            ulongProp = default;
            stringProp = "";
            enumProp = default;
        }

        /// <summary>
        /// Gets the property test data.
        /// </summary>
        /// <value>The property test data.</value>
        /// <autogeneratedoc />
        static IEnumerable<object[]> PropTestData => new[] {
        new object[]{nameof(boolProp), true ,false},
        new object[]{nameof(boolProp), false, true},
        new object[]{nameof(intProp), 0,1},
        new object[]{nameof(intProp), 1,2},
        new object[]{nameof(intProp), -1,0},
        new object[]{nameof(intProp), int.MaxValue,int.MaxValue-1},
        new object[]{nameof(intProp), int.MinValue,int.MinValue+1},
        new object[]{nameof(uintProp), 0u,1u},
        new object[]{nameof(uintProp), 1u,2u},
        new object[]{nameof(uintProp), uint.MaxValue,uint.MaxValue-1u},
        new object[]{nameof(uintProp), uint.MinValue, uint.MinValue+1u },
        new object[]{nameof(floatProp), 0f,float.Epsilon},
        new object[]{nameof(floatProp), 1f,2f},
        new object[]{nameof(floatProp), float.MaxValue,float.MaxValue*0.99999f},
        new object[]{nameof(floatProp), float.MinValue, float.MinValue*0.99999f},
        new object[]{nameof(floatProp), float.PositiveInfinity,float.MaxValue},
        new object[]{nameof(floatProp), float.NegativeInfinity, float.MinValue},
        new object[]{nameof(floatProp), float.NaN, float.Epsilon*2f},
        new object[]{nameof(doubleProp), 0d, double.Epsilon},
        new object[]{nameof(doubleProp), 1d,2d},
        new object[]{nameof(doubleProp), double.MaxValue, double.MaxValue*0.99999d},
        new object[]{nameof(doubleProp), double.MinValue, double.MinValue*0.99999d},
        new object[]{nameof(doubleProp), double.PositiveInfinity, double.MaxValue},
        new object[]{nameof(doubleProp), double.NegativeInfinity, double.MinValue},
        new object[]{nameof(doubleProp), double.NaN, double.Epsilon*2d},
        new object[]{nameof(shortProp), (short)0, (short)1 },
        new object[]{nameof(shortProp), (short)1, (short)2 },
        new object[]{nameof(shortProp), (short)-1, (short)0 },
        new object[]{nameof(shortProp), short.MaxValue, (short)(short.MaxValue-1) },
        new object[]{nameof(shortProp), short.MinValue, (short)(short.MinValue+ 1) },
        new object[]{nameof(ushortProp), (ushort)0u, (ushort)1u },
        new object[]{nameof(ushortProp), (ushort)1u, (ushort)2u },
        new object[]{nameof(ushortProp), ushort.MaxValue, (ushort)(ushort.MaxValue- 1u) },
        new object[]{nameof(ushortProp), ushort.MinValue, (ushort)(ushort.MinValue+ 1u) },
        };


        /// <summary>
        /// Sets up test.
        /// </summary>
        /// <param name="Prop">The property.</param>
        /// <param name="oVal">The o value.</param>
        /// <param name="oVal2">The o val2.</param>
        /// <autogeneratedoc />
        [DataTestMethod()]
        [DynamicData(nameof(PropTestData))]
        public void SetUpTest(string Prop, object oVal, object oVal2)
        {
            SetVal(Prop, oVal);
            Assert.AreEqual(oVal, GetValue(Prop));
            Assert.AreNotEqual(oVal2, GetValue(Prop));
            Clear();
            SetVal(Prop, oVal2);
            Assert.AreEqual(oVal2, GetValue(Prop));
            Assert.AreNotEqual(oVal, GetValue(Prop));
            this[Prop] = oVal;
            Assert.AreEqual(oVal, this[Prop]);
        }

        /// <summary>
        /// Gets the property test.
        /// </summary>
        /// <param name="Prop">The property.</param>
        /// <param name="oVal">The o value.</param>
        /// <param name="oVal2">The o val2.</param>
        /// <autogeneratedoc />
        [DataTestMethod()]
        [DynamicData(nameof(PropTestData))]
        public void GetPropTest(string Prop, object oVal, object oVal2)
        {
            SetVal(Prop, oVal);
            Assert.AreEqual(oVal, this.GetProp(Prop));
            Assert.AreNotEqual(oVal2, this.GetProp(Prop));
            SetVal(Prop, oVal);
            Assert.AreEqual(oVal, this.GetProp(Prop));
            Assert.AreNotEqual(oVal2, this.GetProp(Prop));
            Assert.AreEqual(null, this.GetProp(Prop + "_"));
        }

        /// <summary>
        /// Gets the property test1.
        /// </summary>
        /// <param name="Prop">The property.</param>
        /// <param name="oVal">The o value.</param>
        /// <param name="oVal2">The o val2.</param>
        /// <autogeneratedoc />
        [DataTestMethod()]
        [DynamicData(nameof(PropTestData))]
        public void GetPropTest1(string Prop, object oVal, object oVal2)
        {
            SetVal(Prop, oVal);
            Assert.AreEqual(oVal, this.GetProp(Prop,oVal2));
            Assert.AreNotEqual(oVal2, this.GetProp(Prop,oVal2));
            SetVal(Prop, oVal2);
            Assert.AreEqual(oVal2, this.GetProp(Prop,oVal));
            Assert.AreNotEqual(oVal, this.GetProp(Prop,oVal));
            SetVal(Prop, oVal);
            Assert.AreEqual(oVal2, this.GetProp(Prop+"_", oVal2));
            Assert.AreNotEqual(oVal, this.GetProp(Prop + "_", oVal2));
        }

        /// <summary>
        /// Sets the property test.
        /// </summary>
        /// <param name="Prop">The property.</param>
        /// <param name="oVal">The o value.</param>
        /// <param name="oVal2">The o val2.</param>
        /// <autogeneratedoc />
        [DataTestMethod()]
        [DynamicData(nameof(PropTestData))]
        public void SetPropTest(string Prop, object oVal, object oVal2)
        {
            this.SetProp(Prop, oVal);
            Assert.AreEqual(oVal, GetValue(Prop));
            Assert.AreNotEqual(oVal2, GetValue(Prop));
            this.SetProp(Prop, oVal2);
            Assert.AreEqual(oVal2, GetValue(Prop));
            Assert.AreNotEqual(oVal, GetValue(Prop));
            this.SetProp(Prop+"_", oVal);
            Assert.AreEqual(oVal2, GetValue(Prop));
        }

        /// <summary>
        /// Defines the test method SetPropTest2.
        /// </summary>
        /// <autogeneratedoc />
        [TestMethod()]
        public void SetPropTest2()
        {
            this.SetProp(nameof(stringProp), (string)null!);
            Assert.AreEqual(null, stringProp);
            this.SetProp(nameof(objectProp), "Hallo");
            Assert.AreEqual(null, stringProp);
        }

        /// <summary>
        /// Defines the test method GetPropTest2.
        /// </summary>
        /// <autogeneratedoc />
        [TestMethod()]
        public void GetPropTest2()
        {
#if NET5_0_OR_GREATER
            Assert.AreEqual(objectProp, this.GetProp<object,object>(nameof(objectProp), null!));
#else
            Assert.ThrowsException<ArgumentNullException>(()=> this.GetProp<object,object>(nameof(objectProp), null!));
#endif
        }

        /// <summary>
        /// Indexes the of test.
        /// </summary>
        /// <param name="item">The item.</param>
        /// <param name="arr">The arr.</param>
        /// <param name="iExp">The i exp.</param>
        /// <autogeneratedoc />
        [DataTestMethod()]
        [DataRow(5,new object[] {1,3,5,7,9 },2)]
        [DataRow(1, new object[] { 1, 3, 5, 7, 9 }, 0)]
        [DataRow(20, new object[] { 1, 3, 5, 7, 9 }, -1)]
        [DataRow("World", new string[] { "Hello", "beautiful", "new", "World", "!" }, 3)]
        [DataRow("Hello", new string[] { "Hello", "beautiful", "new", "World", "!" }, 0)]
        [DataRow("Bumlux", new string[] { "Hello", "beautiful", "new", "World", "!" }, -1)]
        public void IndexOfTest(object item, object[] arr, int iExp)
        {
            Assert.AreEqual(iExp,arr.IndexOf(item));
        }

        /// <summary>
        /// Enums the member test.
        /// </summary>
        /// <param name="name">The name.</param>
        /// <param name="peExp">The pe exp.</param>
        /// <autogeneratedoc />
        [DataTestMethod()]
        [DataRow(nameof(intProp),PropEnum.intProp)]
        [DataRow(nameof(boolProp), PropEnum.boolProp)]
        [DataRow(nameof(enumProp), PropEnum.enumProp)]
        [DataRow(nameof(objectProp), PropEnum.objectProp)]
        [DataRow(nameof(stringProp), PropEnum.stringProp)]
        [DataRow("BlaBla", null)]
        public void EnumMemberTest(string name,PropEnum? peExp)
        {
            Assert.AreEqual(peExp,typeof(PropEnum).EnumMember(name));
        }

        /// <summary>
        /// Defines the test method EnumMemberTest2.
        /// </summary>
        /// <autogeneratedoc />
        [TestMethod()]
        public void EnumMemberTest2()
        {
            Assert.ThrowsException<ArgumentException>(()=> typeof(string).EnumMember("Hallo"));
        }

    }
}