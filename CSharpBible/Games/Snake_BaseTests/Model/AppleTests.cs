// ***********************************************************************
// Assembly         : Snake_BaseTests
// Author           : Mir
// Created          : 08-26-2022
//
// Last Modified By : Mir
// Last Modified On : 09-09-2022
// ***********************************************************************
// <copyright file="AppleTests.cs" company="JC-Soft">
//     Copyright (c) JC-Soft. All rights reserved.
// </copyright>
// <summary></summary>
// ***********************************************************************
using Microsoft.VisualStudio.TestTools.UnitTesting;
using System.Drawing;

/// <summary>
/// The Tests namespace.
/// </summary>
/// <autogeneratedoc />
namespace Snake_Base.Models.Tests
{
    /// <summary>
    /// Defines test class AppleTests.
    /// </summary>
    [TestClass()]
    public class AppleTests
    {
        #region Properties
        /// <summary>
        /// The result data
        /// </summary>
        /// <autogeneratedoc />
        private string ResultData="";

        #region TestResults
        /// <summary>
        /// The c exp result0
        /// </summary>
        /// <autogeneratedoc />
        private readonly string cExpResult0= "DataChange: Snake_Base.Models.Playfield2D`1[Snake_Base.Models.SnakeGameObject]\to:\tn:Snake_Base.Models.Apple\tp:Items\r\n";
        /// <summary>
        /// The c exp result1
        /// </summary>
        /// <autogeneratedoc />
        private readonly string cExpResult1= "DataChange: Snake_Base.Models.Playfield2D`1[Snake_Base.Models.SnakeGameObject]\to:\tn:Snake_Base.Models.Apple\tp:Items\r\n";
        /// <summary>
        /// The c exp result2
        /// </summary>
        /// <autogeneratedoc />
        private readonly string cExpResult2 = "DataChange: Snake_Base.Models.Playfield2D`1[Snake_Base.Models.SnakeGameObject]\to:\tn:Snake_Base.Models.Apple\tp:Items\r\n";

        /// <summary>
        /// The c exp result4
        /// </summary>
        /// <autogeneratedoc />
        private readonly string cExpResult4 = "DataChange: Snake_Base.Models.Playfield2D`1[Snake_Base.Models.SnakeGameObject]\to:\tn:Snake_Base.Models.Apple\tp:Items\r\n";
        /// <summary>
        /// The c exp result move
        /// </summary>
        /// <autogeneratedoc />
        private readonly string cExpResultMove= "DataChange: Snake_Base.Models.Playfield2D`1[Snake_Base.Models.SnakeGameObject]\to:\tn:Snake_Base.Models.Apple\tp:Items\r\nDataChange: Snake_Base.Models.Apple\to:{X=1,Y=2}\tn:{X=2,Y=0}\tp:Place\r\n";
        #endregion

        /// <summary>
        /// The PLF
        /// </summary>
        internal Playfield2D<SnakeGameObject>? plf;
        #endregion
        /// <summary>
        /// Initializes this instance.
        /// </summary>
        [TestInitialize()]
        public void Init()
        {
            ResultData = "";
            plf = new Playfield2D<SnakeGameObject>(new Size(3, 3));
            plf.OnDataChanged += LogDataChanged;
        }

        /// <summary>
        /// Defines the test method AppleTest2.
        /// </summary>
        [TestMethod()]
        public void AppleTest2()
        {
            Point pp = Point.Empty;    
            var _testApple = new Apple(pp=new Point(1,2),plf);
            Assert.AreEqual(_testApple, plf?[pp]);
            Assert.AreEqual(cExpResult2, ResultData);
        }

        /// <summary>
        /// Defines the test method AppleTest1.
        /// </summary>
        [TestMethod()]
        public void AppleTest1()
        {
            Point pp = Point.Empty;
            var _testApple = new Apple(pp = new Point(2, 1));
            Assert.AreEqual(null, plf?[pp]);
            _testApple.Parent = plf;
            Assert.AreEqual(_testApple, plf?[pp]);
            Assert.AreEqual(cExpResult1, ResultData);
        }

        /// <summary>
        /// Defines the test method AppleTest0.
        /// </summary>
        [TestMethod()]
        public void AppleTest0()
        {
            Point pp = new Point(2, 0);
            var _testApple = new Apple();
            _testApple.Place = pp; 
            Assert.AreEqual(null, plf?[pp]);
            _testApple.Parent = plf;
            Assert.AreEqual(_testApple, plf?[pp]);
            Assert.AreEqual(cExpResult0, ResultData);
        }

        /// <summary>
        /// Defines the test method AppleTest4.
        /// </summary>
        [TestMethod()]
        public void AppleTest4()
        {
            Apple.DefaultParent = plf;
            Point pp = Point.Empty;
            var _testApple = new Apple(pp = new Point(1, 2));
            Assert.AreEqual(_testApple, plf?[pp]);
            Assert.AreEqual(cExpResult4, ResultData);
        }

        /// <summary>
        /// Defines the test method AppleMoveTest.
        /// </summary>
        [TestMethod()]
        public void AppleMoveTest()
        {
            Apple.DefaultParent = plf;
            Point pp = Point.Empty;
            var _testApple = new Apple(pp = new Point(1, 2));
            Assert.AreEqual(_testApple, plf?[pp]);
            Point pp1 = new Point(2, 0);
            Assert.AreEqual(null, plf?[pp1]);
            _testApple.Place = pp1;
            Assert.AreEqual(_testApple, plf?[pp1]);
            Assert.AreEqual(null, plf?[pp]);
            Assert.AreEqual(cExpResultMove, ResultData);
        }

        /// <summary>
        /// Logs the data changed.
        /// </summary>
        /// <param name="sender">The sender.</param>
        /// <param name="e">The e.</param>
        /// <autogeneratedoc />
        private void LogDataChanged(object? sender, (string prop, object? oldVal, object? newVal) e)
        {
            ResultData += $"DataChange: {sender}\to:{e.oldVal}\tn:{e.newVal}\tp:{e.prop}\r\n";
        }

    }
}