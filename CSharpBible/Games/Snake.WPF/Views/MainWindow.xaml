<Window
    x:Class="Snake.WPF.Views.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:conv="clr-namespace:Snake.WPF.Converters"
    Title="Snake"
    Width="900"
    Height="650"
    KeyDown="OnKeyDown">
    <Window.Resources>
        <conv:GridPointsConverter x:Key="GridPointsConverter" />
        <conv:SnakeTileToBrushConverter x:Key="SnakeTileToBrushConverter" />
    </Window.Resources>
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="3*" />
            <ColumnDefinition Width="2*" />
        </Grid.ColumnDefinitions>

        <Border
            Grid.Column="0"
            Margin="12"
            Background="#1E1E1E"
            CornerRadius="8">
            <ItemsControl>
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <UniformGrid Columns="{Binding size.Width}" Rows="{Binding size.Height}" />
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>
                <ItemsControl.ItemsSource>
                    <Binding Converter="{StaticResource GridPointsConverter}" Path="size" />
                </ItemsControl.ItemsSource>
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <Border Margin="1" CornerRadius="2">
                            <Border.Background>
                                <MultiBinding Converter="{StaticResource SnakeTileToBrushConverter}">
                                    <Binding Path="." />
                                    <Binding Path="DataContext.Tiles" RelativeSource="{RelativeSource AncestorType=ItemsControl}" />
                                </MultiBinding>
                            </Border.Background>
                        </Border>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </Border>

        <StackPanel
            Grid.Column="1"
            Margin="12"
            VerticalAlignment="Top">
            <TextBlock
                FontSize="28"
                FontWeight="SemiBold"
                Text="Snake" />
            <TextBlock Margin="0,12,0,0" Text="Score:" />
            <TextBlock FontSize="22" Text="{Binding Score}" />
            <StackPanel Margin="0,20,0,0" Orientation="Horizontal">
                <Button Click="OnStartClick" Content="Start" />
                <Button
                    Margin="8,0,0,0"
                    Command="{Binding PauseCommand}"
                    Content="Pause" />
                <Button
                    Margin="8,0,0,0"
                    Command="{Binding ResetCommand}"
                    Content="Reset" />
            </StackPanel>
        </StackPanel>
    </Grid>
</Window>
