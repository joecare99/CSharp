using Microsoft.VisualStudio.TestTools.UnitTesting;
using BaseLib.Helper;
using AA22_AvlnCap.Model;
using System;
using Avalonia;
using Avalonia.Controls.ApplicationLifetimes;

namespace AA22_AvlnCap.Tests;

internal class TestApp : App
{
    public void DoInit()
    {
        Initialize();
        ApplicationLifetime = new ClassicDesktopStyleApplicationLifetime();
        OnFrameworkInitializationCompleted();
    }
}
[TestClass()]
public class AppTests 
{
    static TestApp app = new();
    private Func<Type, object?> _gsold = null!;
    private Func<Type, object> _grsold = null!;

    /// <summary>
    /// Initializes this instance.
    /// </summary>
    /// <autogeneratedoc />
    [TestInitialize]
    public void Init()
    {
        _gsold = IoC.GetSrv;
        _grsold = IoC.GetReqSrv;
    }

    [TestCleanup]
    public void CleanUp()
    {
        IoC.GetSrv = _gsold;
        IoC.GetReqSrv = _grsold;
    }

    [TestMethod]
    public void AppTest()
    {
        Assert.IsNotNull(app);
    }

    [TestMethod]
    public void AppInit_SetsIoC()
    {
        app.DoInit();
        Assert.IsNotNull(IoC.GetReqSrv(typeof(IWpfCapModel)));
    }
}
