// ***********************************************************************
// Assembly         : BaseLib
// Author           : Mir
// Created          : 03-27-2023
//
// Last Modified By : Mir
// Last Modified On : 03-27-2023
// ***********************************************************************
// <copyright file="MathUtilities.cs" company="JC-Soft">
//     Copyright © JC-Soft 2023
// </copyright>
// <summary></summary>
// ***********************************************************************
using System;
using System.Linq;

/// <summary>
/// The Helper namespace.
/// </summary>
/// <autogeneratedoc />
namespace BaseLib.Helper
{
    /// <summary>
    /// Class MathUtilities.
    /// </summary>
    /// <autogeneratedoc />
    public static class MathUtilities
    {
        /// <summary>
        /// ps the t1.
        /// </summary>
        /// <param name="newValue">The new value.</param>
        /// <param name="actValue">The actual value.</param>
        /// <param name="dTn_Ta">The d tn ta.</param>
        /// <param name="KP">The kp.</param>
        /// <returns>System.Double.</returns>
        /// <autogeneratedoc />
        public static double PT1(this double newValue, ref double actValue, double dTn_Ta = 0.1d, double KP = 1.0d) 
            => actValue = dTn_Ta * KP * newValue + (1d - dTn_Ta) * actValue;

        /// <summary>
        /// Means the specified buffer.
        /// </summary>
        /// <param name="newValue">The new value.</param>
        /// <param name="buffer">The buffer.</param>
        /// <param name="ix">The ix.</param>
        /// <returns>System.Double.</returns>
        /// <autogeneratedoc />
        public static double Mean(this double newValue, double[] buffer, ref int ix)
        {
            buffer[ix++] = newValue;
            ix %= buffer.Length;
            return buffer.Average(); 
        }
        /// <summary>
        /// Medians the specified buffer.
        /// </summary>
        /// <param name="newValue">The new value.</param>
        /// <param name="buffer">The buffer.</param>
        /// <param name="ix">The ix.</param>
        /// <param name="fMedian">The f median.</param>
        /// <returns>System.Double.</returns>
        /// <autogeneratedoc />
        public static double Median(this double newValue, double[] buffer, ref int ix, double fMedian = 0.5d)
        {
            buffer[ix++] = newValue;
            ix %= buffer.Length;
            var b = buffer.ToList<double>();
            b.Sort();
            return b[(int)Math.Floor(b.Count * fMedian)];
        }
    }
}
